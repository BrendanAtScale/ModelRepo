unique_name: dates copy
object_type: dataset
label: date
columns:
  - name: Month
    data_type: string
  - name: USE_DATE
    data_type: date
  - name: Year
    data_type: decimal(4,0)
connection_id: con_Snowflake-SZVMYZL-XGA86303_qds
sql: >
  SELECT DISTINCT cast(START_TIME AS date) use_date, year(START_TIME) AS "Year",
  monthname(START_TIME) AS "Month"

  FROM SNOWFLAKE.ACCOUNT_USAGE.warehouse_metering_history

  UNION 

  SELECT DISTINCT CAST(END_TIME AS date) use_date, year(END_TIME) AS "Year",
  monthname(END_TIME) AS "Month"

  FROM SNOWFLAKE.ACCOUNT_USAGE.warehouse_metering_history

  UNION

  SELECT DISTINCT CAST(START_TIME AS date) use_date, year(START_TIME) AS "Year",
  monthname(START_TIME) AS "Month"

  FROM SNOWFLAKE.ACCOUNT_USAGE.query_history

  UNION 

  SELECT DISTINCT CAST(END_TIME AS date) use_date, year(END_TIME) AS "Year",
  monthname(END_TIME) AS "Month"

  FROM SNOWFLAKE.ACCOUNT_USAGE.query_history
